function secretChatv2(input) {
    let message = input.shift()
    let commandParser = {
        "InsertSpace": (message, index) => {
            return message.slice(0, index) + " " + message.slice(index, message.length)
        },
        "Reverse": (message, substring) => {
            if (message.includes(substring)) {
                let index = message.indexOf(substring)
                substring = substring.split("").reverse().join("")
                return message.slice(0, index) + substring
            } else {
                return `error`
            }
        },
        "ChangeAll": (message, substr, replacement) => {
            while (message.includes(substr)) {
                message = message.replace(substr, replacement)
            } return message
        }

    }

    input.forEach((line) => {
        if (line !== `Reveal`) {
            let [command, ...tokens] = line.split(":|:")

            let oldMessage = message

            message = commandParser[command](message, ...tokens)
            console.log(message)

        } else {
            console.log(`You have a new text message: ${message}`)
        }

    })


}
secretChatv2(
    [
        'heVVodar!gniV',
        'ChangeAll:|:V:|:l',
        'Reverse:|:!gnil',
        'InsertSpace:|:5',
        'Reveal'
    ]

)
